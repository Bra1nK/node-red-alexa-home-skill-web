<% include ../fragments/header.ejs %>
  <div class="container main-content">
    <div id="changePassword">
      <h3>Enter New Password</h3>
      <label style="width: 75px" for="password">Password:</label>
      <input type="password" id="password"/>
      <br>
      <label style="width: 75px" for="password">Password:</label>
      <input type="password" id="passwordAgain"/>
      <br>
      <button id="registerButton">Submit</button>
      <script type="application/javascript">

        var xhr = new XMLHttpRequest();
        var button = document.getElementById('registerButton');
        button.onclick = function(){
          var password = document.getElementById('password').value;
          var passwordAgain = document.getElementById('passwordAgain').value;

          if (password !== passwordAgain) {
            alert("Passwords don't match");
            return;
          }

          if (password.length < 1) {
            alert("Zero length passwords are note really a good idea");
            return;
          }

          var params = "password=" + encodeURIComponent(password);
          xhr.open('POST', '/changePassword',true);
          xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
          xhr.onreadystatechange = function () {
            if( xhr.readyState == 4 && xhr.status == 200) {
              //new user created
              window.location = '/';
            } else if (xhr.readyState == 4 && xhr.status == 400) {
              //show error
              alert(xhr.responseText);
            }
          }
          
          xhr.send(params);

        }
      </script>
    </div>
  </div>
<% include ../fragments/footer.ejs %>